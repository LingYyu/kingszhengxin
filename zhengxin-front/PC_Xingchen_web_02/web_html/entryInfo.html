<!DOCTYPE html>
<html lang="zh-CN">

	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="description" content="手机贷征信平台,星辰后台">
		<title>kings征信-录入基本信息</title>

		<!-- Bootstrap core CSS -->
		<link href="../dist/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
		<!-- Latest compiled and minified CSS -->
		<link href="../dist/css/web_style.css" rel="stylesheet" type="text/css">
		<link href="../dist/css/bootstrapValidator.css" rel="stylesheet" />
		<link href="../dist/css/buttons.css" rel="stylesheet" type="text/css">
		<link href="../dist/css/fileinput.min.css" media="all" rel="stylesheet" type="text/css" />
		<script type="text/javascript" src="../dist/js/angular-1.4.6.min.js"></script>
	</head>

	<body>
		<nav class="navbar navbar-fixed-top navbar-credit">
			<div class="container">
				<div class="navbar-header">
					<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
					<a class="logo_a" href="#">Project name</a>
				</div>
				<div id="navbar" class="collapse navbar-collapse">
					<ul class="nav navbar-nav nav_ul">
						<li class="active">
							<a href="creatUser.html">新建用户</a>
						</li>
						<li>
							<a href="user.html">用户列表</a>
						</li>
						<li>
							<a href="history.html">查询历史</a>
						</li>
						<li>
							<a href="account.html">账户信息</a>
						</li>
					</ul>
					<div class="sigin_out">
						<a href="singin.html">退出</a>
					</div>
				</div>
			</div>
		</nav>

		<div class="container container-fluid">
			<div class="row">
				<ol class="breadcrumb_web">
					<li class="active">核验身份<i class="glyphicon glyphicon-menu-right"></i></li>
					<li class="active">录入基本信息<i class="glyphicon glyphicon-menu-right"></i></li>
					<li>
						<a href="#">选择查询模块<i class="glyphicon glyphicon-menu-right"></i></a>
					</li>
					<li>
						<a href="#">上传补充资料<i class="glyphicon glyphicon-menu-right"></i></a>
					</li>
					<li>
						<a href="#">生成报告</a>
					</li>
				</ol>
			</div>
			<div class="blank_20"></div>
			<form class="form-horizontal" role="form" id="entryInfoForm" name="entryInfoForm">
				<div class="row">
					<div class="form-group form_infor">
						<label class="col-sm-offset-3 col-sm-2">公司地址：</label>
						<div class="col-sm-4">
							<input type="text" class="form-control form-control_red" placeholder="精确到门牌号" name="companyAddress" onchange="noEmpty(this)" onkeyup="noEmpty(this)" id="companyAddress">
						</div>
					</div>
				</div>

				<div class="row">
					<div class="form-group form_infor">
						<label class="col-sm-offset-3 col-sm-2">公司电话：</label>
						<div class="col-sm-4">
							<input type="text" class="form-control form-control_red" placeholder="区号-固定电话" name="companyTel" onchange="checkTel(this)" onkeyup="checkTel(this)" id="companyTel" >
						</div>
					</div>
				</div>

				<div class="row">
					<div class="form-group form_infor">
						<label class="col-sm-offset-3 col-sm-2" for="inputEmail">常用邮箱：</label>
						<div class="col-sm-4">
							<input type="email" id="email" class="form-control form-control_red" placeholder="xxx@xxx.com" name="email" onchange="checkEmail(this)" onkeyup="checkEmail(this)" >
						</div>
					</div>
				</div>
				<div class="row">
					<div class="form-horizontal">
						<div class="row">
							<div class="col-sm-10 col-md-offset-1 col-sm-offset-1">
								<div class="col-sm-4 col-md-4 img_div">
									<label>身份证正面+授权书+签名</label>
									<img src="../dist/images/images_001.jpg" class="mg-rounded-disc center-block" alt="...">
									<a href="##" data-toggle="modal" data-target="#myModal">样例</a>
									<input name="p1" type="file" id="P1" class="hidden" accept="image/jpeg,image/png" onchange="fileChange(this)" required="required"/>
								</div>
								<div class="col-sm-4 col-md-4 img_div">
									<label>身份证反面+授权书+签名</label>
									<img src="../dist/images/images_001.jpg" class="mg-rounded-disc center-block" alt="...">
									<a href="##" data-toggle="modal" data-target="#myModal">样例</a>
									<input type="file" id="P2" class="hidden" accept="image/jpeg,image/png" onchange="fileChange(this)" required="required"/>
								</div>
								<div class="col-sm-4 col-md-4 img_div">
									<label>证件照</label>
									<img src="../dist/images/images_002.jpg" class="mg-rounded-disc center-block" alt="...">
									<a href="##" data-toggle="modal" data-target="#myModal_code">样例</a>
									<input type="file" id="P3" class="hidden" accept="image/jpeg,image/png" onchange="fileChange(this)" required="required"/>
								</div>
							</div>
							<div class="row">
								<div class="img_div">
									<label>每个附件不超过10M,支持jpg、png格式</label>
								</div>
							</div>
							<div class="row">
								<div class="col-sm-4 col-sm-offset-4">
									<button id="next" type="button" class="btn btn-lg btn-block btn-credit" onclick="checkAll()" style="pointer-events: none; opacity:0.5;">下一步</button>
								</div>
							</div>
						</div>
					</div>
				</div>
			</form>
			<!-- 模态框（Modal） -->
			<!-- 身份证正面+授权书+签名样例弹框 -->
			<div class="modal fade bs-example-modal-sm" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static">
				<div class="modal-dialog modal-sm" role="document" style="width: 636px;">
					<div class="modal-content">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close" style="position: absolute;z-index: 1001;right: 20px;"><span aria-hidden="true">&times;</span></button>
						<img src="../dist/images/u202.png" />
					</div>

				</div>
				<!-- /.modal-dialog -->
			</div>
			<!-- /.modal -->
			<!-- 证件照 -->
			<!-- 模态框（Modal） -->
			<div class="modal fade bs-example-modal-sm" id="myModal_code" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static">
				<div class="modal-dialog modal-sm" role="document" style="width: 351px;">
					<div class="modal-content">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close" style="position: absolute;z-index: 1001;right: 2px;"><span aria-hidden="true">&times;</span></button>
						<img src="../dist/images/ID_sample.png" />
					</div>

				</div>
				<!-- /.modal-dialog -->
			</div>
			<!-- /.modal -->
				<!-- 模态框（Modal） -->
				<!-- 上传图片失败 -->
		<div class="modal fade bs-example-modal-sm" id="checkimg" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static">
			<div class="modal-dialog modal-sm" role="document" style="width: 300px;">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
						<h4 class="modal-title" id="myModalLabel">上传失败</h4>
					</div>
					<div class="modal-body" style="text-align: center; font-size: 18px;">
						<div class="blank_20"></div>
						<p id="myModalContent"></p>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-credit btn-block" data-dismiss="modal" id="modal_btn">确定</button>
					</div>
				</div>
				<!-- /.modal-content -->
			</div>
			<!-- /.modal-dialog -->
		</div>
		
		<div class="modal fade bs-example-modal-sm" style="z-index: 9999;" id="siginWei" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static">
			<div class="modal-dialog modal-sm" role="document" style="width: 300px;">
				<div class="modal-content">
					
					<div class="modal-body" style="text-align: center; font-size: 18px;">
						<div class="blank_20"></div>
						<p id="myModalContent">
							请先登录
						</p>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-credit btn-block" data-dismiss="modal" id="modal_btn" onclick="toSigin()">确定</button>
					</div>
				</div>
				<!-- /.modal-content -->
			</div>
			<!-- /.modal-dialog -->
		</div>
		
		</div>
	
		<script src="../dist/js/jquery-2.1.1.js" type="text/javascript"></script>
		<script src="../dist/js/bootstrap.js" type="text/javascript"></script>
		<script src="../dist/js/bootstrapValidator.js" type="text/javascript"></script>
		<script src="../dist/js/jquery-ui.min.js" type="text/javascript"></script>
		<script type="text/javascript" src="../dist/js/common.js" ></script>
		<script type="text/javascript" src="../dist/js/login/login.js"></script>
		<script type="text/javascript" src="../dist/js/login/uploadImage.js"></script>
		<script type="text/javascript" src="../dist/js/plugins/ajaxfileupload.js"></script>
		<script>
			function checkAll() {
				var companyAddress = $("#companyAddress").val();
				var companyTel = $("#companyTel").val();
				var email = $("#email").val();
				console.log($("#P1").val());
				console.log($("#P2").val());
				console.log($("#P3").val());
				$.ajaxFileUpload({
					url: "http://localhost:9999/insertTobaseInfoTable",
					secureuri: false,
					fileElementId: ['P1','P2','P3'],
					dataType: "jsonp",
					jsonp: "checkAll",
					jsonpCallback: "success_jsonpCallback",
					data: {
						"companyAddress": companyAddress,
						"companyTel": companyTel,
						"email": email
					},
					success: function(data) {
						alert(date);
						if(data == 200) {
							window.location.href = "select_model.html";
						} else {
							window.location.href = "entryInfo.html";
						}
					},error: function(data) {
						window.location.href = "select_model.html";
						console.log(data);
						
					}
				});	
			}

				
			
			function getObjectURL(file) {
				var url = null;
				if(window.createObjectURL != undefined) { // basic
					url = window.createObjectURL(file);
				} else if(window.URL != undefined) { // mozilla(firefox)
					url = window.URL.createObjectURL(file);
				} else if(window.webkitURL != undefined) { // webkit or chrome
					url = window.webkitURL.createObjectURL(file);
				}
				return url;
			}
			$(function() {
				$("input[type='file']").on("change", function() {
					var objUrl = getObjectURL(this.files[0]); //获取图片的路径，该路径不是图片在本地的路径
					if(objUrl) {
						$(this).siblings("img").attr("src", objUrl); //将图片路径存入src中，显示出图片
					}
				});
				$(".mg-rounded-disc").on("click", function() {
					$(this).siblings("input[type='file']").click();
				});
			});
			/**
			 * 邮箱格式验证
			 * @param {String} str
			 */
			function IsEmail(str) {
				var myReg = /^([-_A-Za-z0-9\.]+)@([_A-Za-z0-9]+\.)+[A-Za-z0-9]{2,3}$/;
				if(myReg.test(str)) {
					return true;
				} else {
					return false;
				}
			}
			/**
			 * 判断当前对象是否为空
			 * @method isEmpty
			 * @param {Object} obj
			 * @return {Boolean} empty 当为 null,undefined,"" 将返回true
			 */
			function isEmpty(obj) {
				return(obj == null || typeof obj == "undefined" || obj.length == 0)
			}

			/**
			 * 判断当前对象是否非空
			 * @method isNotEmpty
			 * @param {Object} obj
			 * @return {Boolean}
			 */
			function isNotEmpty(obj) {
				return !isEmpty(obj);
			}

			function noEmpty(event) {
				if(isNotEmpty($(event).val())) {
					$(event).removeClass('form-control_red');
				} else {
					$(event).addClass('form-control_red');
				}
			}

			function checkTel(event) {
				if(isPhone($(event).val())) {
					$(event).removeClass('form-control_red');
				} else {
					$(event).addClass('form-control_red');
				}
			}

			function isPhone(tel) {
				var isPhone = /^([0-9]{3,4})(-|\/)[0-9]{7,8}$/;
				//var isMob = /^((\+?86)|(\(\+86\)))?(13[012356789][0-9]{8}|15[012356789][0-9]{8}|18[02356789][0-9]{8}|147[0-9]{8}|1349[0-9]{7})$/;
				//var value = tel.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
				if(isPhone.test(tel)) {
					return true;
				} else {
					return false;
				}
			}

			function checkEmail(event) {
				if(IsEmail($(event).val())) {
					$(event).removeClass('form-control_red');
				} else {
					$(event).addClass('form-control_red');
				}
			}

			
		</script>
	</body>

</html>